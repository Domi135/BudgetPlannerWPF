<UserControl x:Class="BudgetPlannerWPF.Views.IncomeExpenseFormView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:models="clr-namespace:BudgetPlannerWPF.Models">

    <UserControl.Resources>
        <!-- Use the framework BooleanToVisibilityConverter -->
        <BooleanToVisibilityConverter x:Key="BoolToVisibilityConverter"/>
    </UserControl.Resources>

    <!-- Collapse the entire form when IsFormVisible is false -->
    <Border Background="White" Padding="20" CornerRadius="10"
            BorderBrush="#CCCCCC" BorderThickness="1" Width="350"
            Visibility="{Binding IsFormVisible, Converter={StaticResource BoolToVisibilityConverter}}">

        <StackPanel>

            <!-- INCOME PANEL: visible when EditingIncome is NOT null -->
            <StackPanel>
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <!-- hide when EditingIncome is null -->
                            <DataTrigger Binding="{Binding EditingIncome}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>

                <TextBlock Text="Titel:"/>
                <TextBox Text="{Binding EditingIncome.Title}"/>

                <TextBlock Text="Belopp:"/>
                <TextBox Text="{Binding EditingIncome.Amount}"/>

                <TextBlock Text="Datum:"/>
                <DatePicker SelectedDate="{Binding EditingIncome.Date}"/>

                <TextBlock Text="Typ:"/>
                <ComboBox ItemsSource="{Binding TransactionTypes}"
                          SelectedItem="{Binding EditingIncome.TransactionType}"/>

                <TextBlock Text="Kategori:"/>
                <ComboBox ItemsSource="{Binding IncomeCategories}"
                          SelectedItem="{Binding EditingIncome.Category}"/>
            </StackPanel>

            <!-- EXPENSE PANEL: visible when EditingExpense is NOT null -->
            <StackPanel>
                <StackPanel.Style>
                    <Style TargetType="StackPanel">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <!-- hide when EditingExpense is null -->
                            <DataTrigger Binding="{Binding EditingExpense}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </StackPanel.Style>

                <TextBlock Text="Titel:"/>
                <TextBox Text="{Binding EditingExpense.Title}"/>

                <TextBlock Text="Belopp:"/>
                <TextBox Text="{Binding EditingExpense.Amount}"/>

                <TextBlock Text="Datum:"/>
                <DatePicker SelectedDate="{Binding EditingExpense.Date}"/>

                <TextBlock Text="Typ:"/>
                <ComboBox ItemsSource="{Binding TransactionTypes}"
                          SelectedItem="{Binding EditingExpense.TransactionType}"/>

                <TextBlock Text="Kategori:"/>
                <ComboBox ItemsSource="{Binding ExpenseCategories}"
                          SelectedItem="{Binding EditingExpense.Category}"/>
            </StackPanel>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
                <Button Content="Spara" Command="{Binding SaveFormCommand}" Width="80"/>
                <Button Content="Avbryt" Command="{Binding CancelFormCommand}" Width="80"/>
            </StackPanel>

        </StackPanel>

    </Border>

</UserControl>